<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guitar Detection System</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <!-- Main Window Frame -->
    <div class="window">
        <!-- Title Bar -->
        <div class="titlebar">
            <span class="titlebar-text">Guitar Detection System</span>
            <div class="titlebar-buttons">
                <span class="titlebar-btn minimize"></span>
                <span class="titlebar-btn maximize"></span>
                <span class="titlebar-btn close"></span>
            </div>
        </div>

        <!-- Menu Bar -->
        <div class="menubar">
            <span class="menu-item">File</span>
            <span class="menu-item">View</span>
            <span class="menu-item">Tools</span>
            <span class="menu-item">Help</span>
        </div>

        <!-- Main Content Area - Three Column Layout -->
        <div class="main-container">

            <!-- LEFT COLUMN - Controls -->
            <div class="column column-left">
                <div class="panel-title">Guitar Detection System</div>
                <div class="panel-subtitle">Video + Audio + Tab Generation</div>

                <!-- Video File Section -->
                <fieldset class="group-box">
                    <legend>Video File</legend>
                    <div class="field-row">
                        <label class="field-label" id="path-label">No file selected</label>
                    </div>
                    <div class="field-row center">
                        <button class="btn" id="browse-btn" onclick="document.getElementById('video-input').click()">Browse...</button>
                        <input type="file" id="video-input" accept="video/*" style="display:none">
                    </div>
                </fieldset>

                <!-- Output File Section -->
                <fieldset class="group-box">
                    <legend>Output File (Optional)</legend>
                    <div class="field-row">
                        <label class="field-label" id="output-label">No output file (display only)</label>
                    </div>
                    <div class="field-row center">
                        <button class="btn" id="output-btn">Save As...</button>
                    </div>
                </fieldset>

                <!-- Audio Preprocessing Section -->
                <fieldset class="group-box">
                    <legend>Audio Preprocessing</legend>
                    <div class="field-row">
                        <input type="checkbox" id="preprocess-check" checked>
                        <label for="preprocess-check">Enable Audio Preprocessing (Demucs/Spleeter)</label>
                    </div>
                    <div class="field-row">
                        <span class="hint-text">Removes background noise and vocals for better frequency detection. This will take a few minutes but greatly improves accuracy.</span>
                    </div>
                </fieldset>

                <!-- Guitar Tuner Section -->
                <fieldset class="group-box">
                    <legend>Guitar Tuner</legend>
                    <div class="tuner-display">
                        <div class="tuner-note" id="tuner-note">--</div>
                        <div class="tuner-freq" id="tuner-frequency">-- Hz</div>
                        <div class="tuner-meter">
                            <div class="meter-track">
                                <div class="meter-center-mark"></div>
                                <div class="meter-needle" id="tuner-needle"></div>
                            </div>
                            <div class="meter-labels">
                                <span>Flat</span>
                                <span>In Tune</span>
                                <span>Sharp</span>
                            </div>
                            <div class="tuner-cents" id="tuner-cents">0 cents</div>
                        </div>
                        <div class="tuner-status" id="tuner-string-info">Press Start to begin tuning</div>
                    </div>
                    <div class="field-row center tuner-buttons">
                        <button class="btn" id="tuner-start">Start Tuner</button>
                        <button class="btn" id="tuner-stop" disabled>Stop</button>
                    </div>
                    <div class="string-reference">
                        <div class="field-row">
                            <span class="hint-text">Standard Tuning Reference (click to play tone):</span>
                        </div>
                        <div class="string-grid">
                            <button class="string-btn" data-freq="329.63" data-note="E4" data-string="1">1: E4 (329.6)</button>
                            <button class="string-btn" data-freq="246.94" data-note="B3" data-string="2">2: B3 (246.9)</button>
                            <button class="string-btn" data-freq="196.00" data-note="G3" data-string="3">3: G3 (196.0)</button>
                            <button class="string-btn" data-freq="146.83" data-note="D3" data-string="4">4: D3 (146.8)</button>
                            <button class="string-btn" data-freq="110.00" data-note="A2" data-string="5">5: A2 (110.0)</button>
                            <button class="string-btn" data-freq="82.41" data-note="E2" data-string="6">6: E2 (82.4)</button>
                        </div>
                    </div>
                </fieldset>

                <!-- Start Detection -->
                <div class="field-row center">
                    <button class="btn btn-start" id="start-btn" disabled>Start Detection</button>
                </div>

                <!-- Status -->
                <div class="status-bar-inline">
                    <label id="status-label">Ready</label>
                </div>

                <!-- Progress Bar -->
                <div class="progress-container" id="progress-container" style="display:none">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width:0%"></div>
                    </div>
                </div>

                <div class="instructions">
                    1. Select video &middot; 2. Start detection &middot; 3. Watch &amp; view tabs
                </div>
            </div>

            <!-- MIDDLE COLUMN - Video Display -->
            <div class="column column-middle">
                <div class="panel-title">Video Preview</div>
                <div class="video-frame">
                    <div class="video-placeholder" id="video-display">
                        No video playing<br><br>Select a video and start detection to see live preview
                    </div>
                </div>
            </div>

            <!-- RIGHT COLUMN - Tab Display -->
            <div class="column column-right">
                <div class="panel-title">Guitar Tablature</div>
                <div class="tab-frame">
                    <textarea class="tab-text" id="tab-display" readonly>No tabs yet. Start detection to generate guitar tabs.

Tabs will appear here in real-time as notes are detected!</textarea>
                </div>
                <div class="field-row center tab-controls">
                    <button class="btn" id="save-tab-btn" disabled>Save Tab...</button>
                    <button class="btn" id="clear-tab-btn" disabled>Clear</button>
                </div>
            </div>

        </div>

        <!-- Bottom Status Bar -->
        <div class="window-statusbar">
            <span id="window-status">Guitar Detection System v1.0</span>
        </div>
    </div>

    <script src="/tuner.js"></script>
    <script src="/app.js"></script>
</body>
</html>
